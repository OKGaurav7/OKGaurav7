import pandas as pd
from itertools import permutations

# Read the CSV file
df = pd.read_csv('your_file.csv')

# Get unique values of 'cNameEMA_x' column
unique_names = df['cNameEMA_x'].unique()

# Create an empty DataFrame to store the result
result_df = pd.DataFrame(columns=df.columns)

# Iterate over each unique name
for name in unique_names:
    # Filter rows with the current name
    name_df = df[df['cNameEMA_x'] == name]
    
    # Get unique values of 'countryCode' for the current name
    unique_countries = name_df['countryCode'].unique()
    
    # Generate permutations of country codes
    for r in range(1, len(unique_countries) + 1):
        for perm in permutations(unique_countries, r):
            # Filter rows with the current combination of country codes
            filtered_df = name_df[name_df['countryCode'].isin(perm)]
            
            # Check if there are any rows left after filtering
            if not filtered_df.empty:
                # Append the filtered DataFrame to the result DataFrame
                result_df = pd.concat([result_df, filtered_df])
                
# Reset the index of the result DataFrame
result_df.reset_index(drop=True, inplace=True)

# Print the result DataFrame
print(result_df)

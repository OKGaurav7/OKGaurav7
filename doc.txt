from openpyxl import load_workbook
from openpyxl.utils import get_column_letter

# Load the workbook
wb = load_workbook('your_excel_file.xlsx')
ws = wb.active

# Define the range for the VLOOKUP function
vlookup_range = "$E$105:$F$109"

# Iterate over rows to calculate and set the formula for the "Economic Impact" column
for row in range(1, ws.max_row + 1):
    # Skip the header row
    if row == 1:
        continue
    
    # Set the formula for the "Economic Impact" column
    formula = f"=(-(E{row}-D{row}))/100*J{row}*VLOOKUP(K{row},{vlookup_range},2,FALSE)"
    ws[f'G{row}'] = formula

# Save the workbook
wb.save('your_excel_file.xlsx')

import pandas as pd

# Read the CSV file
df = pd.read_csv("Gap Metrics.csv")

# Columns to compute average
columns_to_average = ['Shown Dv01', 'Hit Ratio Dv01', 'Fair Hit Rate Dv01', 'Avg Dealers Dv01',
                      'No Quote Dv01', 'Shown Tkts', 'Hit Ratio Tkts', 'Fair Hit Rate Tkts',
                      'Avg Dealers Tkts', 'No Quote Tkts']

# Group by 'cNameEMA_x', 'platform_x', and 'countryCode', compute average for each group
averaged_df = df.groupby(['cNameEMA_x', 'platform_x', 'countryCode'])[columns_to_average].mean().reset_index()

# Save the output to a new CSV file
averaged_df.to_csv("averaged_output.csv", index=False)

import pandas as pd
from itertools import permutations

# Read the CSV file
df = pd.read_csv("your_file.csv")

# Generate permutations of country codes
country_codes = ['DE', 'ES', 'FR', 'IT']
permutations = [p for r in range(len(country_codes)) for p in permutations(country_codes, r+1)]

# Create a new DataFrame to store the results
new_rows = []

# Iterate through each unique combination of cNameEMA_x and primaryProduct_x
for _, group in df.groupby(['cNameEMA_x', 'primaryProduct_x']):
    for perm in permutations:
        for country_code in perm:
            new_row = group.iloc[0].copy()
            new_row['countryCode'] = country_code if country_code != 'All' else ''
            new_rows.append(new_row)

# Concatenate the original DataFrame with the new rows
result_df = pd.concat([df] + new_rows, ignore_index=True)

# Save the result to a new CSV file
result_df.to_csv("output.csv", index=False)

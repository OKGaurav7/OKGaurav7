import win32com.client

def run_excel_macro(excel_file_path, macro_name):
    try:
        xl = win32com.client.Dispatch("Excel.Application")
        xl.Visible = True
        wb = xl.Workbooks.Open(excel_file_path)
        xl.Application.Run("'" + wb.Name + "'!" + macro_name)
        wb.Close(SaveChanges=True)
    except Exception as e:
        print("An error occurred:", e)
    finally:
        xl.Quit()

# Example usage:
excel_file_path = r"C:\path\to\your\excel\file.xlsx"
macro_name = "Module1.YourMacroName"  # Update with the correct module and macro name
run_excel_macro(excel_file_path, macro_name)

import win32com.client

def run_excel_macro(macro_file, macro_name, excel_file):
    xl = win32com.client.Dispatch("Excel.Application")
    xl.Visible = False  # Set to True if you want Excel to be visible during execution
    xl.DisplayAlerts = False  # Set to False to suppress any alerts

    try:
        wb = xl.Workbooks.Open(Filename=macro_file)
        xl.Application.Run("'" + macro_file + "'!" + macro_name)
        wb.Close(SaveChanges=False)
        
        # Open the target workbook
        wb_target = xl.Workbooks.Open(Filename=excel_file)
        # Save the changes in the target workbook
        wb_target.Save()
        # Close the target workbook
        wb_target.Close(SaveChanges=True)
        
    except Exception as e:
        print("An error occurred:", str(e))
    
    xl.Quit()

# Usage example
macro_file = r"path\to\idk.bas"
macro_name = "idk"
excel_file = r"path\to\ab.xlsm"

run_excel_macro(macro_file, macro_name, excel_file)

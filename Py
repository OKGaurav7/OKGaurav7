Sub UpdateFormula()
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim cell As Range
    
    ' Change "Sheet1" to the name of your worksheet
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' Find the last row with data in column G
    lastRow = ws.Cells(ws.Rows.Count, "G").End(xlUp).Row
    
    ' Loop through each cell in column G
    For Each cell In ws.Range("G1:G" & lastRow)
        If IsNumeric(cell.Value) = False Or (Abs(ws.Cells(cell.Row, "A").Value - ws.Cells(cell.Row, "B").Value) > 50) Then
            ' Change the formula if the cell value is non-numeric or the difference between columns A and B is more than 50
            cell.Formula = "=BDP('XYZ','CSMT')"
        End If
    Next cell
End Sub

i have a csv file, with column "cNameEMA_x" ,"primaryProduct_x", "countryCode", ETC;  
there can be multiple entry with same name in "cNameEMA_x",but each of them will have different data in other columns;
column "countryCode" has only following entries:[All,DE,ES,FR,IT] 

code such that for that name add new rows with permutation of all the "countryCode" entries that exist in the csv 

example:  
cNameEMA_x        primaryProduct_x              countryCode               OTHER COLUMNS
ABC                      EGB                           DE                              
ABC                      EGB                           ES
ABC                      EGB                           ER
ABC                      EUR                           ES
XYZ                       EUR                           FR
XYZ                       EUR                           IT 




OUTPUT:

cNameEMA_x         primaryProduct_x         countryCode        OTHER COLUMNS
ABC                     EGB                   DE                              
ABC                     EGB                   ES
ABC                     EGR                   ER
ABC                     EGB                   DE, ES  
ABC                    EGB                   DE, ER
ABC                    EGB                    ER, ES
ABC                    EGB                    DE, ES, ER      
ABC                    EUR                      ES
XYZ                    EUR                    FR
XYZ                    EUR                     IT 
XYZ                    EUR                    FR,IT
for all the names

explaination:
added new rows with the permutation of country code only if the other columns are same(except countryCode) ieCOLUMNS WITH COUNTRYCODE AS('DE','ES','ER',"DE,ES","DE,ER", "ER, ES","DE, ES, ER" )
in the new rows for ABC 































the columns named Shown Dv01, Hit Ratio Dv01, Fair Hit Rate Dv01, Avg Dealers Dv01, No Quote Dv01, Shown Tkts, Hit Ratio Tkts, Fair Hit Rate Tkts,Avg Dealers Tkts, No Quote Tkts, tier
for all these columns perform a average such as fllowing example:

cNameEMA_x    platform_x    countryCode  Shown Dv01  Hit Ratio Dv01  ETC
abc               BBG          DE          5            6            
abc                BBG         IT          4             10
abc                bbg      DE,IT(GOT FROM  4.5          8
                            PREVIOUS CODE)      

avg(5,4)=4.5
similarly for the all the rows and further columns, and if similarly find average for 3 or 4 country code 









from openpyxl import load_workbook

# Load the source Excel file containing the macro
source_wb = load_workbook("source_file.xlsx", keep_vba=True)

# Load the destination Excel file where you want to apply the macro
dest_wb = load_workbook("destination_file.xlsx")

# Copy the VBA code from the source to the destination workbook
for vb_component in source_wb.vba_modules:
    dest_wb.vba_archive.append(vb_component)

# Save the changes to the destination workbook
dest_wb.save("destination_file.xlsx")

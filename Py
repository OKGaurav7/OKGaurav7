import pandas as pd

# Read data from master.xlsx
master_df = pd.read_excel('master.xlsx')

# Read data from Takara.xlsx
takara_df = pd.read_excel('Takara.xlsx')

# Read data from prodman.xlsx
prodman_df = pd.read_excel('prodman.xlsx')

# Merge data from master.xlsx and Takara.xlsx based on 'Counterparty Name' and 'currentObligorId'
merged_df = pd.merge(master_df, takara_df, left_on='Counterparty Name', right_on='currentObligorId', how='left')

# Merge data obtained from step 2 with prodman.xlsx based on 'obligorId'
final_merged_df = pd.merge(merged_df, prodman_df[['obligorId', 'CashScore']], left_on='obligorId', right_on='obligorId', how='left')

# Select required columns
selected_columns = ['Counterparty Name', 'obligorId', 'CashScore']

# Save the final DataFrame to output.xlsx
final_merged_df[selected_columns].to_excel('output.xlsx', index=False)

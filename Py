import xlwings as xw

# Path to the source Excel file with the macro
source_file_path = "path/to/source_file.xlsm"

# Path to the destination Excel file where you want to add the macro
destination_file_path = "path/to/destination_file.xlsm"

# Name of the macro you want to add
macro_name = "YourMacroName"

# Open the source Excel file
source_wb = xw.Book(source_file_path)

# Get a reference to the macro
macro = source_wb.macro(macro_name)

# Open the destination Excel file
destination_wb = xw.Book(destination_file_path)

# Add the macro to the destination Excel file
destination_wb.add_macro(macro)

# Save changes to the destination Excel file
destination_wb.save()

# Close both workbooks
source_wb.close()
destination_wb.close()

import pandas as pd
from datetime import datetime

# Read the master Excel file
master_df = pd.read_excel('master.xlsx')

# Select the specified columns
selected_columns = [
    'counterparty names', 
    'operation type(buy or sell)', 
    'trade date', 
    'trade price', 
    'value date', 
    'primary original quantity', 
    'settlement instrument name', 
    'isin reference', 
    'primary instrument long name', 
    'smoothly trade reference', 
    'internal status narrative', 
    'sales person name'
]

# Create a new DataFrame with only the selected columns
output_df = master_df[selected_columns]

# Define new columns
new_columns = ['CBT', 'economic impact', 'LQA', 'days elapsed']

# Insert new columns after "Trade Price"
output_df = output_df.reindex(columns=output_df.columns.tolist()[:4] + new_columns + output_df.columns.tolist()[4:])

# Add dummy data to new columns
import random
output_df['CBT'] = [random.randint(1, 100) for _ in range(len(output_df))]
output_df['economic impact'] = [random.uniform(1000, 10000) for _ in range(len(output_df))]
output_df['LQA'] = [random.choice(['Good', 'Bad', 'Neutral']) for _ in range(len(output_df))]

# Calculate days elapsed
today = datetime.today()
output_df['days elapsed'] = (today - output_df['value date']).dt.days - 1

# Write the DataFrame to a new Excel file
output_df.to_excel('output.xlsx', index=False, sheet_name='Sheet1')

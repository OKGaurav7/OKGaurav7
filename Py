
# Below the existing code...

# Read the new Excel file into a DataFrame
summary_df = pd.read_excel('new_excel.xlsx')

# Set conditional formatting color to RGB value (255, 199, 206)
condition_fill = PatternFill(start_color="FFC7CE", end_color="FFC7CE", fill_type="solid")

# Iterate over 'Total Fails' column
for i, value in enumerate(summary_df['Total Fails'], start=2):
    cell = ws.cell(row=i, column=summary_df.columns.get_loc('Total Fails') + 1)
    if value > 0:
        cell.fill = condition_fill

# Iterate over 'Overall Economic Impact' column
for i, value in enumerate(summary_df['Overall Economic Impact'], start=2):
    cell = ws.cell(row=i, column=summary_df.columns.get_loc('Overall Economic Impact') + 1)
    if value > 0:
        cell.fill = condition_fill

# Loop through all cells to set font color
for row in ws.iter_rows():
    for cell in row:
        if cell.fill == header_fill:
            cell.font = header_font
        elif cell.fill == condition_fill:
            cell.font = Font(color="C00000")  # Set font color to red

# Save the modified Excel file
wb.save(output_filename)

from openpyxl import load_workbook
from openpyxl.utils import get_column_letter

# Load the workbook
wb = load_workbook('output.xlsx')
ws = wb.active

# Define the range for the VLOOKUP function
vlookup_range = "$T$1:$U$5"

for row in range(1, ws.max_row + 1):
    # Skip the header row
    if row == 1:
        continue
    
    # Set the formula for the "Economic Impact" column
    formula = f"=(-(G{row}-F{row}))/100*L{row}*VLOOKUP(M{row},{vlookup_range},2,FALSE)"
    ws[f'H{row}'] = formula

# Save the workbook
wb.save('output.xlsx')

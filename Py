Sub UpdateFormula()
    Dim ws As Worksheet
    Dim rng As Range
    Dim cell As Range
    
    ' Change "Sheet1" to the name of your worksheet
    Set ws = ThisWorkbook.Sheets("Sheet1")
    
    ' Define the range starting from G2 to the last filled cell in column G
    Set rng = ws.Range("G2", ws.Range("G2").End(xlDown))
    
    ' Loop through each cell in the defined range
    For Each cell In rng
        If Not IsNumeric(cell.Value) Or Abs(ws.Cells(cell.Row, "A").Value - ws.Cells(cell.Row, "B").Value) > 50 Then
            ' Change the formula if the cell value is non-numeric or the difference between columns A and B is more than 50
            cell.Formula = "=BDP('XYZ','CSMT')"
        End If
    Next cell
End Sub

import pandas as pd
from openpyxl import load_workbook

# Load the master Excel file
master_df = pd.read_excel('master.xlsx')

# Get the header names with red fill color
red_headers = []
wb = load_workbook('master.xlsx')
ws = wb.active
for cell in ws[1]:
    if cell.fill.bgColor.rgb == "FFFF0000":  # Check if fill color is red
        red_headers.append(cell.value)

# Filter the DataFrame to include only the columns with red headers
output_df = master_df[red_headers]

# Save the filtered DataFrame to a CSV file
output_df.to_csv('output.csv', index=False)

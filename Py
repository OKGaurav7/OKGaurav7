# Write data to the Excel file, handling illegal characters
for row in output_df.itertuples(index=False, name=None):
    cleaned_row = [str(cell).replace('\x00', '') if isinstance(cell, str) else cell for cell in row]
    ws.append(cleaned_row)

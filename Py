import pandas as pd

# Read data from master.xlsx
master_df = pd.read_excel('master.xlsx')

# Read data from prodman.xlsx
prodman_df = pd.read_excel('prodman.xlsx')

# Merge data based on Counterparty Name (from master.xlsx) and Obligor (from prodman.xlsx)
merged_df = pd.merge(master_df[['Counterparty Name']], prodman_df[['Obligor', 'TradingAccountCode', 'cash score']], left_on='Counterparty Name', right_on='Obligor', how='left')

# Rename columns as per requirement
merged_df.rename(columns={'TradingAccountCode': 'ObligorId'}, inplace=True)

# Fill missing values with "NA"
merged_df.fillna('NA', inplace=True)

# Write the merged data to a new Excel file
merged_df.to_excel('merged_data.xlsx', index=False)
